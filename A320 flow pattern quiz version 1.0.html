<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A320 FLIGHT DECK FLOW PATTERN</title>
    <style>
        :root {
            --p281c: #00205B;      /* Brand Dark Blue */
            --p7696c: #4F758B;     /* Interface Steel Blue */
            --ral7031: #5B686D;    /* Cockpit Blue-Grey */
            --airbus-amber: #FFB400;
            --airbus-green: #2ECC71;
            --text: #FFFFFF;
        }

        body {
            background-color: var(--p281c);
            color: var(--text);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header & Logo */
        header {
            background-color: var(--p7696c);
            width: 100%;
            padding: 20px 0;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            border-bottom: 4px solid var(--airbus-amber);
        }

        .logo-img {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            height: 40px;
            background: white;
            padding: 5px;
            border-radius: 4px;
        }

        /* Layout Containers */
        .container {
            width: 90%;
            max-width: 1100px;
            margin: 30px 0;
            background-color: var(--ral7031);
            padding: 30px;
            border-radius: 15px;
            display: none; /* Controlled by JS */
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
        }

        .active { display: block; }

        /* Home Page Grid */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .menu-card {
            background: var(--p7696c);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            border: 2px solid transparent;
        }

        .menu-card:hover {
            border-color: var(--airbus-amber);
            transform: translateY(-5px);
        }

        /* Quiz Styles */
        .flow-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .column {
            background: rgba(0,0,0,0.25);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .column h2 { text-align: center; margin-top: 0; font-size: 1.1rem; }
        .pf-title { color: #00FF00; }
        .pm-title { color: #FFFF00; }

        .sortable-list {
            list-style: none;
            padding: 0;
            min-height: 300px;
        }

        .item {
            background-color: #f8f9fa;
            color: #2c3e50;
            margin: 10px 0;
            padding: 12px;
            border-radius: 6px;
            cursor: grab;
            font-weight: bold;
            font-size: 0.85rem;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        .item.dragging { opacity: 0.4; }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            margin: 5px;
        }

        .btn-main { background-color: var(--p7696c); color: white; }
        .btn-verify { background-color: var(--airbus-amber); color: black; }
        .btn-answer { background-color: #95a5a6; color: white; }
        .btn-home { background-color: #e74c3c; color: white; }

        /* Image Viewer */
        .image-viewer {
            text-align: center;
            margin-top: 20px;
        }

        .image-viewer img {
            max-width: 100%;
            border: 5px solid var(--p7696c);
            border-radius: 10px;
        }

        .answer-key-section {
            margin-bottom: 50px;
            border-bottom: 2px solid var(--airbus-amber);
            padding-bottom: 20px;
        }
    </style>
</head>
<body>

<header>
    <h1>A320 FLIGHT DECK FLOW PATTERN</h1>
    <img src="input_file_6.png" class="logo-img" alt="A320 Logo">
</header>

<!-- 1. HOME SCREEN -->
<div id="home-screen" class="container active">
    <h2 style="text-align: center;">Select a Training Stage</h2>
    <div class="menu-grid">
        <div class="menu-card" onclick="startQuiz(0)">1. Before Start Flow</div>
        <div class="menu-card" onclick="startQuiz(1)">2. After Start Flow</div>
        <div class="menu-card" onclick="startQuiz(2)">3. Line-Up Flow</div>
        <div class="menu-card" onclick="startQuiz(3)">4. Acceleration Flow</div>
        <div class="menu-card" onclick="startQuiz(4)">5. After Landing Flow</div>
        <div class="menu-card" onclick="startQuiz(5)">6. Parking Flow</div>
    </div>
    <div style="text-align: center; margin-top: 40px;">
        <button class="btn btn-answer" onclick="showAllAnswers()">View All Correct Patterns</button>
    </div>
</div>

<!-- 2. QUIZ SCREEN -->
<div id="quiz-screen" class="container">
    <h2 id="quiz-title" style="color: var(--airbus-amber); text-align: center;"></h2>
    <div class="flow-columns">
        <div class="column">
            <h2 class="pf-title">PILOT FLYING (PF)</h2>
            <ul class="sortable-list" id="pf-list"></ul>
        </div>
        <div class="column">
            <h2 class="pm-title">PILOT MONITORING (PM)</h2>
            <ul class="sortable-list" id="pm-list"></ul>
        </div>
    </div>
    <div style="text-align: center; margin-top: 20px;">
        <p id="feedback"></p>
        <button class="btn btn-home" onclick="goHome()">Home</button>
        <button class="btn btn-verify" onclick="verifyQuiz()">Verify Sequence</button>
    </div>
</div>

<!-- 3. RESULT / IMAGE REVEAL -->
<div id="reveal-screen" class="container">
    <h2 id="reveal-title" style="text-align: center;">Correct Pattern</h2>
    <div class="image-viewer">
        <img id="reveal-img" src="" alt="SOP Diagram">
    </div>
    <div style="text-align: center; margin-top: 20px;">
        <button class="btn btn-main" id="btn-next-step" onclick="nextStep()">Next Stage</button>
        <button class="btn btn-home" onclick="goHome()">Back to Menu</button>
    </div>
</div>

<!-- 4. MASTER ANSWER KEY -->
<div id="answers-screen" class="container">
    <button class="btn btn-home" onclick="goHome()" style="margin-bottom: 20px;">Back to Menu</button>
    <div id="all-answers-content"></div>
</div>

<script>
    const stages = [
        {
            title: "BEFORE START FLOW PATTERN",
            img: "input_file_0.png",
            pf: ["BEACON sw...ON", "WINDOWS...CHECK CLOSED", "DOOR/SLIDES...CHECK CLOSED/ARMED", "THRUST LEVERS...IDLE", "PARK BRK handle...ON"],
            pm: ["ATC...SET FOR OPERATIONS", "WINDOWS...CHECK CLOSED", "DOORS/SLIDES...CHECK CLOSED/ARMED"]
        },
        {
            title: "AFTER START FLOW PATTERN",
            img: "input_file_1.png",
            pf: ["ENG MODE selector...NORM", "APU BLEED pb-sw...OFF", "ANTI ICE...AS RQRD", "APU MASTER SW pb-sw...OFF", "ECAM STATUS...CHECK", "NW STRG DISC MEMO...CHECK NOT DISPLAYED"],
            pm: ["GND SPLRS...ARM", "RUD...CHECK NEUTRAL", "FLAPS...SET", "PITCH TRIM...SET", "ECAM STATUS...CHECK"]
        },
        {
            title: "LINE-UP FLOW PATTERN",
            img: "input_file_2.png",
            pf: ["TAKEOFF RUNWAY...CONFIRM", "APPROACH PATH...CLEAR OF TRAFFIC", "EXTERIOR LIGHTS...SET"],
            pm: ["TCAS mode selector...TA ONLY or TA/RA", "TAKEOFF RUNWAY...CONFIRM", "APPROACH PATH...CLEAR OF TRAFFIC", "PACKS 1 and 2...AS RQRD", "CABIN CREW...ADVISE"]
        },
        {
            title: "ACCELERATION FLOW PATTERN",
            img: "input_file_3.png",
            pf: ["(No PF Actions)"],
            pm: ["FLAPS ZERO...SELECT", "GND SPLRS...DISARM", "L/G...CHECK UP", "EXTERIOR LIGHTS...SET"]
        },
        {
            title: "AFTER LANDING FLOW PATTERN",
            img: "input_file_4.png",
            pf: ["GND SPLRS...DISARM", "EXTERIOR LIGHTS...SET"],
            pm: ["RADAR/PWS...OFF", "ENG MODE selector...NORM", "FLAPS...RETRACT", "TCAS/ATC...STDBY/AS RQRD", "APU...START", "ANTI ICE...AS RQRD"]
        },
        {
            title: "PARKING FLOW PATTERN",
            img: "input_file_5.png",
            pf: ["ACCU PRESS...CHECK", "PARK BRK handle...ON", "YELLOW ELEC PUMP pb-sw...OFF", "ALL ENG MASTER LEVERS...OFF", "EXTERIOR LIGHTS...OFF", "SLIDES...CHECK DISARMED", "SEAT BELTS sw...OFF"],
            pm: ["ANTI ICE...OFF", "APU BLEED pb-sw...AS RQRD", "FUEL PUMPS...OFF", "ATC...STBY", "IRS PERFORMANCE...CHECK", "FUEL QUANTITY...CHECK"]
        }
    ];

    let currentStage = 0;

    function goHome() {
        document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
        document.getElementById('home-screen').classList.add('active');
    }

    function startQuiz(index) {
        currentStage = index;
        document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
        document.getElementById('quiz-screen').classList.add('active');
        document.getElementById('quiz-title').innerText = stages[index].title;
        document.getElementById('feedback').innerText = "";
        
        setupList('pf-list', stages[index].pf);
        setupList('pm-list', stages[index].pm);
    }

    function setupList(id, items) {
        const list = document.getElementById(id);
        list.innerHTML = "";
        let shuffled = [...items].sort(() => Math.random() - 0.5);
        shuffled.forEach(text => {
            const li = document.createElement('li');
            li.className = 'item';
            li.draggable = true;
            li.innerText = text;
            li.dataset.val = text;
            li.addEventListener('dragstart', () => li.classList.add('dragging'));
            li.addEventListener('dragend', () => li.classList.remove('dragging'));
            list.appendChild(li);
        });
        list.addEventListener('dragover', e => {
            e.preventDefault();
            const dragging = document.querySelector('.dragging');
            const afterElement = [...list.querySelectorAll('.item:not(.dragging)')].find(el => {
                return e.clientY <= el.getBoundingClientRect().top + el.getBoundingClientRect().height / 2;
            });
            afterElement ? list.insertBefore(dragging, afterElement) : list.appendChild(dragging);
        });
    }

    function verifyQuiz() {
        const pfOrder = [...document.querySelectorAll('#pf-list .item')].map(i => i.dataset.val);
        const pmOrder = [...document.querySelectorAll('#pm-list .item')].map(i => i.dataset.val);
        const correct = stages[currentStage];

        if (JSON.stringify(pfOrder) === JSON.stringify(correct.pf) && JSON.stringify(pmOrder) === JSON.stringify(correct.pm)) {
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
            const reveal = document.getElementById('reveal-screen');
            reveal.classList.add('active');
            document.getElementById('reveal-img').src = correct.img;
            document.getElementById('reveal-title').innerText = "SUCCESS: " + correct.title;
            document.getElementById('btn-next-step').innerText = currentStage < 5 ? "Next Stage" : "Finish & Restart";
        } else {
            document.getElementById('feedback').innerHTML = "<b style='color:#ff6b6b'>INCORRECT. Check pattern sequence.</b>";
        }
    }

    function nextStep() {
        if (currentStage < 5) {
            startQuiz(currentStage + 1);
        } else {
            goHome();
        }
    }

    function showAllAnswers() {
        document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
        const screen = document.getElementById('answers-screen');
        screen.classList.add('active');
        const content = document.getElementById('all-answers-content');
        content.innerHTML = "";

        stages.forEach(s => {
            content.innerHTML += `
                <div class="answer-key-section">
                    <h3>${s.title}</h3>
                    <img src="${s.img}" style="max-width:100%; border-radius:10px;">
                    <div class="flow-columns" style="margin-top:15px;">
                        <div><h4 class="pf-title">PF</h4><small>${s.pf.join('<br>')}</small></div>
                        <div><h4 class="pm-title">PM</h4><small>${s.pm.join('<br>')}</small></div>
                    </div>
                </div>`;
        });
    }
</script>

</body>
</html>